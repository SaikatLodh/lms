<!DOCTYPE html>
<html lang="en">
  <%- include('./layout/head.ejs') %>

  <body>
    <div id="wrapper">
      <%- include('./layout/sidebar.ejs') %>

      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column">
        <div id="content">
          <%- include('./layout/navbar.ejs') %> <% if(success && success.length
          > 0) { %>
          <div
            class="alert alert-success text-center alert-dismissible fade show success-msg"
            role="alert"
          >
            <%= success %>
            <button
              type="button"
              class="close"
              data-dismiss="alert"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <% } %> <% if(error && error.length > 0) { %>
          <div
            class="alert alert-danger text-center alert-dismissible fade show error-msg"
            role="alert"
          >
            <%= error %>
            <button
              type="button"
              class="close"
              data-dismiss="alert"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <% } %>
          <div
            class="d-flex justify-content-center align-items-center"
           
          >
           <div class="form-container-update">
              <div
                class="d-flex justify-content-center profile-image"
                style="margin: 10px 0px"
              >
                <img
                  src="<%= course?.image.url || 'img/undraw_profile.svg' %>"
                  alt=""
                  style="
                    width: 50px;
                    height: 50px;
                    object-fit: cover;
                    border-radius: 50%;
                  "
                />
              </div>
              <div class="form-header">
                <h2>Update Course</h2>
                <p>Please fill out the form below to get started.</p>
              </div>
              <form
                action="/admin/updateCourse"
                method="POST"
                enctype="multipart/form-data"
               class="registration-form"
              >
              <div class="form-group">
                 
                <input type="hidden" name="courseId" value="<%= course._id %>">
                </div>
                
                
                <div class="form-group">
                  <label for="title">Title</label>
                  <input type="text" name="title" id="title" class="form-control" value="<%= course.title %>" required>
                </div>

                <div class="form-group">
                  <label for="category">Category</label>
                  <input type="text" name="category" id="category" class="form-control" value="<%= course.category %>" required>
                </div>

                <div class="form-group">
                  <label for="level">Level</label>
                  <select name="level" id="level" class="form-control" required>
                    <option value="beginner" <%= course.level === 'beginner' ? 'selected' : '' %>>Beginner</option>
                    <option value="intermediate" <%= course.level === 'intermediate' ? 'selected' : '' %>>Intermediate</option>
                    <option value="advanced" <%= course.level === 'advanced' ? 'selected' : '' %>>Advanced</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="primaryLanguage">Primary Language</label>
                   <select name="primaryLanguage" id="level" class="form-control" required>
                    <option value="English" <%= course.primaryLanguage === 'English' ? 'selected' : '' %>>English</option>
                    <option value="Hindi" <%= course.primaryLanguage === 'Hindi' ? 'selected' : '' %>>Hindi</option>
                    <option value="Spanish" <%= course.primaryLanguage === 'Spanish' ? 'selected' : '' %>>Spanish</option>
                      <option value="French" <%= course.primaryLanguage === 'French' ? 'selected' : '' %>>French</option>
                        <option value="German" <%= course.primaryLanguage === 'German' ? 'selected' : '' %>>German</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="subtitle">Subtitle</label>
                  <input type="text" name="subtitle" id="subtitle" class="form-control" value="<%= course.subtitle %>" required>
                </div>

                <div class="form-group">
                  <label for="description">Description</label>
                  <textarea name="description" id="description" class="form-control" required><%= course.description %></textarea>
                </div>

                <div class="form-group">
                  <label for="welcomeMessage">Welcome Message</label>
                  <textarea name="welcomeMessage" id="welcomeMessage" class="form-control" required><%= course.welcomeMessage %></textarea>
                </div>

                <div class="form-group">
                  <label for="pricing">Pricing</label>
                  <input type="number" name="pricing" id="pricing" class="form-control" value="<%= course.pricing %>" required>
                </div>

              
                <div class="form-group">
                  <label for="courseImage">Course Image</label>
                  <input
                    type="file"
                    id="courseImage"
                    name="courseImage"
                    accept="image/jpeg, image/png, image/jpg"
                  />
                </div>

                <button type="submit" class="submit-btn">Update Course</button>
              </form>
            </div>
        </div>
        </div>

        <%- include('./layout/footer.ejs') %>
      </div>
    </div>

    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fas fa-angle-up"></i>
    </a>

    <!-- Bootstrap core JavaScript-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="/js/sb-admin-2.min.js"></script>

    <!-- Page level plugins -->
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="/js/demo/datatables-demo.js"></script>

    <script>
      const profilImage = document.querySelector(".profile-image img");
      const inputFile = document.querySelector("#courseImage");
      inputFile.addEventListener("change", (event) => {
        const file = event.target.files[0];
        const render = new FileReader();
        render.addEventListener("load", () => {
          profilImage.src = render.result;
        });
        render.readAsDataURL(file);
      });
    </script>

    <script>
      const successMessage = document.querySelector(".success-msg");
      const errorMessage = document.querySelector(".error-msg");

      if (successMessage) {
        setTimeout(function () {
          successMessage.style.display = "none";
        }, 5000);
      }

      if (errorMessage) {
        setTimeout(function () {
          errorMessage.style.display = "none";
        }, 5000);
      }
    </script>

    <script>
      $(document).ready(function() {
        $('.registration-form').on('submit', function(e) {
          var button = $(this).find('.submit-btn');
          button.prop('disabled', true).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Updating Course...');
        });
      });
    </script>
  </body>
</html>
